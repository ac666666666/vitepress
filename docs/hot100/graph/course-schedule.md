# è¯¾ç¨‹è¡¨

[LeetCode å®˜æ–¹é¢˜ç›®é“¾æ¥](https://leetcode.cn/problems/course-schedule/)

## 1. é¢˜ç›®å‘ˆç°

**éš¾åº¦ç­‰çº§**ï¼šğŸŸ¡ ä¸­ç­‰  
**æ ¸å¿ƒè€ƒå¯Ÿç‚¹**ï¼šå›¾ã€æ‹“æ‰‘æ’åºã€æ·±åº¦ä¼˜å…ˆæœç´¢ (DFS)ã€å¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS)

ä½ è¿™ä¸ªå­¦æœŸå¿…é¡»é€‰ä¿® `numCourses` é—¨è¯¾ç¨‹ï¼Œè®°ä¸º `0` åˆ° `numCourses - 1` ã€‚

åœ¨é€‰ä¿®æŸäº›è¯¾ç¨‹ä¹‹å‰éœ€è¦ä¸€äº›å…ˆä¿®è¯¾ç¨‹ã€‚ å…ˆä¿®è¯¾ç¨‹æŒ‰æ•°ç»„ `prerequisites` ç»™å‡ºï¼Œå…¶ä¸­ `prerequisites[i] = [ai, bi]` ï¼Œè¡¨ç¤ºå¦‚æœè¦å­¦ä¹ è¯¾ç¨‹ `ai` åˆ™ **å¿…é¡»** å…ˆå­¦ä¹ è¯¾ç¨‹  `bi` ã€‚

*   ä¾‹å¦‚ï¼Œå…ˆä¿®è¯¾ç¨‹å¯¹ `[0, 1]` è¡¨ç¤ºï¼šæƒ³è¦å­¦ä¹ è¯¾ç¨‹ `0` ï¼Œä½ éœ€è¦å…ˆå®Œæˆè¯¾ç¨‹ `1` ã€‚

è¯·ä½ åˆ¤æ–­æ˜¯å¦å¯èƒ½å®Œæˆæ‰€æœ‰è¯¾ç¨‹çš„å­¦ä¹ ï¼Ÿï¼ˆå³åˆ¤æ–­å›¾ä¸­æ˜¯å¦å­˜åœ¨ç¯ï¼‰

> **ç¤ºä¾‹ 1ï¼š**
>
> **è¾“å…¥**ï¼šnumCourses = 2, prerequisites = [[1,0]]  
> **è¾“å‡º**ï¼štrue  
> **è§£é‡Š**ï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å®Œæˆè¯¾ç¨‹ 0 ã€‚è¿™æ˜¯å¯èƒ½çš„ã€‚

> **ç¤ºä¾‹ 2ï¼š**
>
> **è¾“å…¥**ï¼šnumCourses = 2, prerequisites = [[1,0],[0,1]]  
> **è¾“å‡º**ï¼šfalse  
> **è§£é‡Š**ï¼šæ€»å…±æœ‰ 2 é—¨è¯¾ç¨‹ã€‚å­¦ä¹ è¯¾ç¨‹ 1 ä¹‹å‰ï¼Œä½ éœ€è¦å…ˆå®Œæˆâ€‹è¯¾ç¨‹ 0 ï¼›å¹¶ä¸”å­¦ä¹ è¯¾ç¨‹ 0 ä¹‹å‰ï¼Œä½ è¿˜åº”å…ˆå®Œæˆè¯¾ç¨‹ 1 ã€‚è¿™æ˜¯ä¸å¯èƒ½çš„ã€‚

---

## 2. è§£é¢˜æ€è·¯æ‹†è§£

è¿™é“é¢˜æœ¬è´¨ä¸Šæ˜¯åˆ¤æ–­ä¸€ä¸ª **æœ‰å‘å›¾** æ˜¯å¦å­˜åœ¨ **ç¯**ã€‚
å¦‚æœå­˜åœ¨ç¯ï¼Œåˆ™æ— æ³•å®Œæˆæ‰€æœ‰è¯¾ç¨‹ï¼›å¦‚æœä¸å­˜åœ¨ç¯ï¼Œåˆ™å¯ä»¥ï¼ˆè¿™æ˜¯ä¸€ä¸ªæœ‰å‘æ— ç¯å›¾ DAGï¼‰ã€‚

å¸¸ç”¨çš„æ–¹æ³•æ˜¯ **æ‹“æ‰‘æ’åº (Topological Sort)**ã€‚

### æ–¹æ³•ä¸€ï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ (BFS) - Kahn ç®—æ³•

1.  **å…¥åº¦ (In-degree)**ï¼šè¡¨ç¤ºæœ‰å¤šå°‘é—¨è¯¾æ˜¯å½“å‰è¯¾ç¨‹çš„å…ˆä¿®è¯¾ã€‚
2.  **æ„å»ºå›¾**ï¼š
    *   ä½¿ç”¨é‚»æ¥è¡¨ `adj` å­˜å‚¨å›¾ç»“æ„ï¼ˆ`u -> [v1, v2...]` è¡¨ç¤ºå­¦å®Œ u æ‰èƒ½å­¦ vï¼‰ã€‚
    *   ç»Ÿè®¡æ¯ä¸ªèŠ‚ç‚¹çš„å…¥åº¦ `inDegree`ã€‚
3.  **BFS æµç¨‹**ï¼š
    *   å°†æ‰€æœ‰ **å…¥åº¦ä¸º 0** çš„è¯¾ç¨‹ï¼ˆæ²¡æœ‰ä»»ä½•å…ˆä¿®è¯¾ï¼Œå¯ä»¥ç›´æ¥å­¦ï¼‰åŠ å…¥é˜Ÿåˆ—ã€‚
    *   å½“é˜Ÿåˆ—ä¸ä¸ºç©ºæ—¶ï¼š
        *   å–å‡ºé˜Ÿé¦–è¯¾ç¨‹ `u`ã€‚
        *   å°†å·²ä¿®è¯¾ç¨‹æ•° `count` åŠ  1ã€‚
        *   éå† `u` çš„æ‰€æœ‰åç»§è¯¾ç¨‹ `v`ï¼š
            *   å°† `v` çš„å…¥åº¦å‡ 1ï¼ˆç›¸å½“äº `u` è¿™é—¨å…ˆä¿®è¯¾å·²ç»æå®šäº†ï¼‰ã€‚
            *   å¦‚æœ `v` çš„å…¥åº¦å˜ä¸º 0ï¼Œè¯´æ˜ `v` çš„æ‰€æœ‰å…ˆä¿®è¯¾éƒ½ä¿®å®Œäº†ï¼Œå¯ä»¥å°† `v` åŠ å…¥é˜Ÿåˆ—ã€‚
4.  **ç»“æœåˆ¤æ–­**ï¼š
    *   å¦‚æœæœ€ç»ˆ `count` ç­‰äº `numCourses`ï¼Œè¯´æ˜æ‰€æœ‰è¯¾ç¨‹éƒ½èƒ½ä¿®å®Œï¼ˆæ²¡æœ‰ç¯ï¼‰ã€‚
    *   å¦åˆ™ï¼Œè¯´æ˜æœ‰ç¯ï¼ˆå‰©ä¸‹çš„è¯¾ç¨‹å…¥åº¦éƒ½ä¸ä¸º 0ï¼Œäº’ä¸ºå…ˆä¿®ï¼Œå¡æ­»äº†ï¼‰ã€‚

### æ–¹æ³•äºŒï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ (DFS)

DFS ä¹Ÿå¯ä»¥åˆ¤æ–­ç¯ã€‚æˆ‘ä»¬éœ€è¦ä¸‰ä¸ªçŠ¶æ€æ¥æ ‡è®°èŠ‚ç‚¹ï¼š
*   **æœªè®¿é—® (0)**ï¼šè¿˜æ²¡æœè¿‡ã€‚
*   **è®¿é—®ä¸­ (1)**ï¼šæ­£åœ¨æœè¯¥èŠ‚ç‚¹çš„å­èŠ‚ç‚¹ï¼ˆåœ¨å½“å‰é€’å½’æ ˆä¸­ï¼‰ã€‚
*   **å·²å®Œæˆ (2)**ï¼šè¯¥èŠ‚ç‚¹åŠå…¶å­èŠ‚ç‚¹éƒ½æœå®Œäº†ï¼Œæ²¡å‘ç°ç¯ã€‚

å¦‚æœåœ¨ DFS è¿‡ç¨‹ä¸­é‡åˆ°äº†çŠ¶æ€ä¸º **è®¿é—®ä¸­ (1)** çš„èŠ‚ç‚¹ï¼Œè¯´æ˜é‡åˆ°äº†å›è¾¹ï¼Œå­˜åœ¨ç¯ã€‚

é€šå¸¸ **BFS (Kahn ç®—æ³•)** æ›´ç›´è§‚ï¼Œä¹Ÿæ˜¯æ‹“æ‰‘æ’åºçš„æ ‡å‡†è§£æ³•ã€‚

---

## 3. ä»£ç å®ç° (BFS / Kahn ç®—æ³•)

```javascript
/**
 * @param {number} numCourses
 * @param {number[][]} prerequisites
 * @return {boolean}
 */
var canFinish = function(numCourses, prerequisites) {
    // 1. åˆå§‹åŒ–é‚»æ¥è¡¨å’Œå…¥åº¦æ•°ç»„
    const inDegree = new Array(numCourses).fill(0);
    const adj = new Array(numCourses).fill(0).map(() => []);
    
    // 2. æ„å»ºå›¾
    for (const [course, pre] of prerequisites) {
        // pre -> course (æƒ³å­¦ courseï¼Œå…ˆå­¦ pre)
        adj[pre].push(course);
        inDegree[course]++;
    }
    
    // 3. å°†æ‰€æœ‰å…¥åº¦ä¸º 0 çš„èŠ‚ç‚¹å…¥é˜Ÿ
    const queue = [];
    for (let i = 0; i < numCourses; i++) {
        if (inDegree[i] === 0) {
            queue.push(i);
        }
    }
    
    let count = 0; // è®°å½•å·²ä¿®å®Œçš„è¯¾ç¨‹æ•°é‡
    
    // 4. BFS
    while (queue.length > 0) {
        const curr = queue.shift();
        count++;
        
        // éå†å½“å‰è¯¾ç¨‹çš„æ‰€æœ‰åç»­è¯¾ç¨‹
        for (const next of adj[curr]) {
            inDegree[next]--;
            // å¦‚æœåç»­è¯¾ç¨‹çš„å…¥åº¦å˜ä¸º 0ï¼Œè¯´æ˜å…ˆä¿®è¯¾éƒ½ä¿®å®Œäº†
            if (inDegree[next] === 0) {
                queue.push(next);
            }
        }
    }
    
    // 5. åˆ¤æ–­æ˜¯å¦æ‰€æœ‰è¯¾ç¨‹éƒ½ä¿®å®Œäº†
    return count === numCourses;
};
```

#### ä»£ç æ‰§è¡Œæ¼”ç¤º
è¾“å…¥ï¼š`numCourses = 4`, `prerequisites = [[1,0], [2,0], [3,1], [3,2]]`
(0->1, 0->2, 1->3, 2->3)

1.  **Init**:
    *   In-degree: `[0, 1, 1, 2]` (Course 0 has 0, 1 has 1 (from 0), 2 has 1 (from 0), 3 has 2 (from 1,2))
    *   Adj: `0->[1,2]`, `1->[3]`, `2->[3]`, `3->[]`.
    *   Queue: `[0]`
2.  **BFS**:
    *   Pop `0`. `count`=1.
        *   Neighbors of 0: `1`, `2`.
        *   `inDegree[1]`-- -> 0. Push `1`.
        *   `inDegree[2]`-- -> 0. Push `2`.
        *   Queue: `[1, 2]`.
    *   Pop `1`. `count`=2.
        *   Neighbors of 1: `3`.
        *   `inDegree[3]`-- -> 1.
        *   Queue: `[2]`.
    *   Pop `2`. `count`=3.
        *   Neighbors of 2: `3`.
        *   `inDegree[3]`-- -> 0. Push `3`.
        *   Queue: `[3]`.
    *   Pop `3`. `count`=4.
        *   No neighbors.
        *   Queue: `[]`.
3.  **End**: `count` (4) === `numCourses` (4). Return `true`.

---

## 4. å¤æ‚åº¦åˆ†æ

| ç»´åº¦ | æè¿° |
| :--- | :--- |
| **æ—¶é—´å¤æ‚åº¦** | $O(V + E)$ã€‚$V$ æ˜¯è¯¾ç¨‹æ•°ï¼Œ$E$ æ˜¯å…ˆä¿®å…³ç³»æ•°ã€‚æˆ‘ä»¬éœ€è¦éå†æ‰€æœ‰èŠ‚ç‚¹å’Œè¾¹ã€‚ |
| **ç©ºé—´å¤æ‚åº¦** | $O(V + E)$ã€‚é‚»æ¥è¡¨å­˜å‚¨å›¾éœ€è¦ $O(V + E)$ï¼Œå…¥åº¦æ•°ç»„éœ€è¦ $O(V)$ï¼Œé˜Ÿåˆ—éœ€è¦ $O(V)$ã€‚ |
